name: Deploy to Development

on:
  workflow_dispatch:
    inputs:
      branch:
        description: "Branch to deploy"
        required: false
        default: "develop"
        type: string

jobs:
  deploy:
    name: Deploy to Development
    uses: ./.github/workflows/deploy.yml
    with:
      environment: development
      app_name: ${{ github.event.repository.name }}-dev
      compose_file: docker-compose.dev.yml
      env_vars: |
        FRONTEND_URL=${{ vars.FRONTEND_URL || 'https://appname-dev.nugo.dev' }}
        BACKEND_URL=${{ vars.BACKEND_URL || 'https://appname-dev-api.nugo.dev' }}
        CADDY_FRONTEND_LABEL=${{ vars.CADDY_FRONTEND_LABEL || 'appname-dev.nugo.dev' }}
        CADDY_BACKEND_LABEL=${{ vars.CADDY_BACKEND_LABEL || 'appname-dev-api.nugo.dev' }}
        FRONTEND_PORT=${{ vars.FRONTEND_PORT || '3000' }}
        BACKEND_PORT=${{ vars.BACKEND_PORT || '5000' }}
    secrets:
      SSH_HOST: ${{ secrets.SSH_HOST }}
      SSH_USER: ${{ secrets.SSH_USER }}
      SSH_KEY: ${{ secrets.SSH_KEY }}
